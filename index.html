<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dasbor - PulseSirkel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* Tailwind slate-100 */
        }
        .gradient-bg {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .card {
            @apply bg-white p-6 rounded-xl shadow-md transition-all duration-300;
        }
        .sidebar-link {
            @apply flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-emerald-50 hover:text-emerald-600 rounded-lg font-medium transition-colors;
        }
        .sidebar-link.active {
            @apply bg-emerald-100 text-emerald-700;
        }
        .page-content {
            display: none;
        }
        .page-content.active {
            display: block;
        }
        .skeleton {
            @apply bg-gray-200 rounded animate-pulse;
        }
        /* Tab Styles */
        .tab-button {
            @apply px-4 py-2 font-semibold text-gray-500 rounded-md transition-colors;
        }
        .tab-button.active {
            @apply bg-emerald-500 text-white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        /* Sidebar transition */
        #sidebar {
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="text-gray-700">
    <div class="relative min-h-screen md:flex">
        <!-- Overlay for mobile sidebar -->
        <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden"></div>

        <!-- Sidebar -->
        <aside id="sidebar" class="fixed inset-y-0 left-0 bg-white shadow-lg w-64 transform -translate-x-full md:relative md:translate-x-0 z-30 flex flex-col">
            <div class="flex items-center justify-between h-24 border-b px-2">
                 <div class="text-center w-full">
                    <div class="flex items-center justify-center space-x-2">
                        <div class="p-2 bg-emerald-500 rounded-full">
                            <i data-lucide="heart-pulse" class="text-white"></i>
                        </div>
                        <span class="text-2xl font-bold text-emerald-600">PulseSirkel</span>
                    </div>
                    <p class="text-[10px] text-gray-500 mt-1 leading-tight">
                       CAH LANANG JOS JIS<br>
                        UNTUK KEPERLUAN LOMBA ABCC JEJAK 2025
                    </p>
                </div>
                <button id="sidebar-close" class="md:hidden p-2">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <nav id="sidebar-nav" class="flex-1 px-4 py-6 space-y-2 overflow-y-auto">
                <a href="#" class="sidebar-link active" data-target="dasbor" data-title="Selamat Datang, Budi!">
                    <i data-lucide="layout-dashboard"></i>
                    <span>Dasbor</span>
                </a>
                 <a href="#" class="sidebar-link" data-target="asisten-ai" data-title="Asisten Kesehatan AI">
                    <i data-lucide="bot"></i>
                    <span>Asisten AI</span>
                </a>
                <a href="#" class="sidebar-link" data-target="sirkel-vital" data-title="Aktivitas SirkelVital">
                    <i data-lucide="award"></i>
                    <span>SirkelVital</span>
                </a>
                <a href="#" class="sidebar-link" data-target="sirkel-bakti" data-title="Pantau SirkelBakti">
                    <i data-lucide="heart-handshake"></i>
                    <span>SirkelBakti</span>
                </a>
                <a href="#" class="sidebar-link" data-target="rekomendasi-ai" data-title="Jadwal & Rekomendasi">
                    <i data-lucide="brain-circuit"></i>
                    <span>Jadwal & Rekomendasi</span>
                </a>
                <a href="#" class="sidebar-link" data-target="marketplace" data-title="Jelajahi Marketplace">
                    <i data-lucide="shopping-cart"></i>
                    <span>Marketplace</span>
                </a>
                <a href="#" class="sidebar-link" data-target="dompet" data-title="Dompet PulseToken">
                    <i data-lucide="wallet"></i>
                    <span>Dompet Token</span>
                </a>
                 <a href="#" class="sidebar-link" data-target="perangkat" data-title="Perangkat Terhubung">
                    <i data-lucide="watch"></i>
                    <span>Perangkat Terhubung</span>
                </a>
                 <a href="#" class="sidebar-link" data-target="profil" data-title="Profil Saya">
                    <i data-lucide="user"></i>
                    <span>Profil Saya</span>
                </a>
                 <a href="#" class="sidebar-link" data-target="tata-kelola" data-title="Tata Kelola Komunitas">
                    <i data-lucide="vote"></i>
                    <span>Tata Kelola</span>
                </a>
            </nav>
            <div class="px-4 py-6 border-t">
                 <a href="#" class="sidebar-link bg-red-50 text-red-600 hover:bg-red-100">
                    <i data-lucide="log-out"></i>
                    <span>Keluar</span>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="flex justify-between items-center p-4 sm:p-6 bg-white border-b">
                <div class="flex items-center">
                    <button id="menu-toggle" class="md:hidden mr-4 text-gray-600">
                        <i data-lucide="menu"></i>
                    </button>
                    <h1 id="page-title" class="text-2xl font-bold text-gray-800">Selamat Datang, Budi!</h1>
                </div>
                <div class="flex items-center space-x-4">
                     <div class="relative">
                        <button id="notif-toggle" class="relative text-gray-500 hover:text-gray-700">
                            <i data-lucide="bell"></i>
                            <span class="absolute top-0 right-0 h-2 w-2 bg-emerald-500 rounded-full"></span>
                        </button>
                        <!-- Notification Dropdown -->
                        <div id="notif-dropdown" class="hidden absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl overflow-hidden z-10">
                            <div class="py-2 px-4 font-bold text-gray-700 border-b">Notifikasi</div>
                            <div class="divide-y">
                                <a href="#" class="flex items-start space-x-3 px-4 py-3 hover:bg-gray-50">
                                    <i data-lucide="gift" class="text-emerald-500 mt-1"></i>
                                    <div>
                                        <p class="font-semibold text-sm">Selamat! Anda mendapat +5 Token</p>
                                        <p class="text-xs text-gray-500">Dari tidur yang cukup semalam.</p>
                                    </div>
                                </a>
                                <a href="#" class="flex items-start space-x-3 px-4 py-3 hover:bg-gray-50">
                                    <i data-lucide="zap" class="text-yellow-500 mt-1"></i>
                                    <div>
                                        <p class="font-semibold text-sm">Tantangan baru tersedia!</p>
                                        <p class="text-xs text-gray-500">'Jalan Pagi 30 Menit' menanti Anda.</p>
                                    </div>
                                </a>
                                <a href="#" class="flex items-start space-x-3 px-4 py-3 hover:bg-gray-50">
                                    <i data-lucide="alert-circle" class="text-blue-500 mt-1"></i>
                                    <div>
                                        <p class="font-semibold text-sm">Rekomendasi AI</p>
                                        <p class="text-xs text-gray-500">Jadwal kontrol kesehatan disarankan.</p>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                         <img src="https://placehold.co/40x40/E2E8F0/475569?text=B" class="w-10 h-10 rounded-full" alt="User Avatar">
                         <div class="hidden sm:block">
                            <div class="font-semibold text-gray-800">Budi Santoso</div>
                            <div class="text-sm text-gray-500">Status: Peserta Emas</div>
                         </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-4 sm:p-6">
                <!-- Dasbor Content -->
                <div id="dasbor-content" class="page-content active">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Left Column -->
                        <div class="lg:col-span-2 space-y-6">
                            <!-- PulseToken Balance Card -->
                            <div class="card gradient-bg text-white shadow-lg">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-lg font-medium opacity-80">Saldo PulseToken Anda</p>
                                        <p class="text-4xl font-bold flex items-center space-x-2 mt-1">
                                            <i data-lucide="bitcoin" class="w-8 h-8"></i>
                                            <span>1,257.75</span>
                                        </p>
                                        <p class="mt-2 opacity-80">Setara dengan ~Rp 125.775 (+Rp 700 hari ini)</p>
                                    </div>
                                    <button id="tukar-token-btn" class="px-5 py-2 bg-white/30 text-white font-semibold rounded-lg hover:bg-white/40 transition">
                                        Tukar Token
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Gemini AI Health Assistant Card -->
                            <div class="card">
                                <div class="flex items-center space-x-3 mb-4">
                                    <i data-lucide="bot" class="text-emerald-500 w-6 h-6"></i>
                                    <h3 class="text-xl font-bold text-gray-800">Asisten Kesehatan AI</h3>
                                </div>
                                <div class="p-4 bg-emerald-50 rounded-lg">
                                    <p class="font-medium text-emerald-800 mb-3">Tips Cerdas Hari Ini:</p>
                                    <div id="ai-tip-response">
                                        <!-- Skeleton loader -->
                                        <div class="space-y-2">
                                            <div class="skeleton h-4 w-full"></div>
                                            <div class="skeleton h-4 w-3/4"></div>
                                        </div>
                                    </div>
                                </div>
                                <form id="ai-prompt-form" class="mt-4">
                                    <div class="relative">
                                        <input type="text" id="ai-prompt-input" placeholder="Tanya tentang kesehatan Anda..." class="w-full pl-4 pr-12 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                                        <button type="submit" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-emerald-500 text-white rounded-md hover:bg-emerald-600">
                                            <i data-lucide="send" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- SirkelVital: Active Challenges -->
                            <div class="card">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Aktivitas SirkelVital</h3>
                                <div class="space-y-4">
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="font-medium">Tantangan 10.000 Langkah Harian</span>
                                            <span class="text-sm font-semibold text-emerald-600">+10 Token/hari</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                                            <div class="bg-emerald-500 h-2.5 rounded-full" style="width: 75%"></div>
                                        </div>
                                        <p class="text-right text-sm text-gray-500 mt-1">7,500 / 10,000 Langkah</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div class="lg:col-span-1 space-y-6">
                             <!-- Daily Summary Card -->
                             <div class="card">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Ringkasan Hari Ini</h3>
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="footprints" class="text-blue-500"></i>
                                            <span class="font-medium">Langkah</span>
                                        </div>
                                        <span id="langkah-data" class="font-bold text-gray-700">7,500</span>
                                    </div>
                                     <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="bed-double" class="text-indigo-500"></i>
                                            <span class="font-medium">Tidur</span>
                                        </div>
                                        <span id="tidur-data" class="font-bold text-gray-700">7j 15m</span>
                                    </div>
                                     <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="heart-pulse" class="text-red-500"></i>
                                            <span class="font-medium">Detak Jantung</span>
                                        </div>
                                        <span class="font-bold text-gray-700">72 bpm</span>
                                    </div>
                                </div>
                            </div>
                             <!-- Auto Token Earnings -->
                            <div class="card bg-emerald-50 border border-emerald-200">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Token Otomatis Hari Ini</h3>
                                <ul class="space-y-3">
                                    <li class="flex justify-between items-center">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="bed-double" class="text-blue-500"></i>
                                            <span class="font-medium">Tidur Cukup</span>
                                        </div>
                                        <span class="font-bold text-emerald-600">+5 Token</span>
                                    </li>
                                    <li class="flex justify-between items-center">
                                        <div class="flex items-center space-x-3">
                                            <i data-lucide="heart-pulse" class="text-red-500"></i>
                                            <span class="font-medium">Detak Jantung Stabil</span>
                                        </div>
                                        <span class="font-bold text-emerald-600">+2 Token</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                 <!-- Asisten AI Content (Full Page) -->
                <div id="asisten-ai-content" class="page-content">
                    <div class="card max-w-4xl mx-auto">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Asisten Kesehatan AI</h2>
                        <p class="text-gray-600 mb-6">Tanyakan apa saja tentang gaya hidup sehat, nutrisi, atau olahraga. Asisten AI akan membantu Anda.</p>
                        
                        <div id="ai-chat-response" class="h-80 overflow-y-auto bg-gray-50 p-4 rounded-lg mb-4 border">
                            <p class="text-center text-gray-500">Silakan ajukan pertanyaan Anda di bawah.</p>
                        </div>
                        
                        <div id="ai-chat-loading" class="hidden text-center my-4">
                            <div role="status" class="flex justify-center items-center space-x-2">
                               <svg aria-hidden="true" class="w-6 h-6 text-gray-200 animate-spin dark:text-gray-600 fill-emerald-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
                                    <path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0492C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"/>
                                </svg>
                                <span class="text-gray-600">AI sedang berpikir...</span>
                            </div>
                        </div>
                         <form id="ai-chat-form" class="mt-4">
                            <div class="relative">
                                <input type="text" id="ai-chat-input" placeholder="Tanya tentang kesehatan Anda..." class="w-full pl-4 pr-12 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                                <button type="submit" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-emerald-500 text-white rounded-md hover:bg-emerald-600">
                                    <i data-lucide="send" class="w-5 h-5"></i>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Rekomendasi AI Content -->
                <div id="rekomendasi-ai-content" class="page-content">
                    <div class="space-y-6">
                        <div class="card bg-blue-50 border border-blue-200">
                            <h2 class="text-2xl font-bold text-blue-800 mb-3">Jadwal Kontrol Kesehatan Anda</h2>
                            <p class="text-blue-700 mb-4">Berdasarkan analisis data detak jantung istirahat dan pola tidur Anda selama 3 bulan terakhir, AI kami merekomendasikan Anda untuk melakukan pemeriksaan kesehatan umum.</p>
                            <div class="bg-white p-4 rounded-lg text-center">
                                <p class="text-lg font-semibold text-gray-700">Waktu yang Disarankan:</p>
                                <p class="text-3xl font-bold text-blue-600 my-2">Oktober - November 2025</p>
                                <button class="mt-4 w-full md:w-auto px-6 py-2 bg-blue-500 text-white font-semibold rounded-lg hover:bg-blue-600 transition">
                                    Buat Jadwal Sekarang
                                </button>
                            </div>
                        </div>

                        <div class="card">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">Rekomendasi Rumah Sakit Terdekat</h2>
                             <div class="space-y-4">
                                <!-- Hospital 1 -->
                                <div class="flex flex-col md:flex-row items-start md:items-center justify-between p-4 border rounded-lg hover:shadow-lg transition">
                                    <div class="flex items-start space-x-4">
                                        <div class="bg-emerald-100 p-3 rounded-lg">
                                            <i data-lucide="hospital" class="w-8 h-8 text-emerald-600"></i>
                                        </div>
                                        <div>
                                            <p class="font-bold text-lg text-gray-800">RS Mitra Keluarga Surabaya</p>
                                            <p class="text-sm text-gray-500">~5 km dari lokasi Anda</p>
                                            <div class="mt-2 flex items-center space-x-2 text-xs">
                                                <span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded-full font-medium">Pusat Jantung Unggulan</span>
                                                <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded-full font-medium">Mitra Platinum</span>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="mt-4 md:mt-0 w-full md:w-auto px-4 py-2 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition">
                                        Buat Janji
                                    </button>
                                </div>
                                <!-- Hospital 2 -->
                                <div class="flex flex-col md:flex-row items-start md:items-center justify-between p-4 border rounded-lg hover:shadow-lg transition">
                                     <div class="flex items-start space-x-4">
                                         <div class="bg-emerald-100 p-3 rounded-lg">
                                            <i data-lucide="hospital" class="w-8 h-8 text-emerald-600"></i>
                                        </div>
                                        <div>
                                            <p class="font-bold text-lg text-gray-800">RS Permata Surabaya</p>
                                            <p class="text-sm text-gray-500">~7 km dari lokasi Anda</p>
                                            <div class="mt-2 flex items-center space-x-2 text-xs">
                                                <span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded-full font-medium">Layanan Cepat</span>
                                                <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded-full font-medium">Mitra Emas</span>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="mt-4 md:mt-0 w-full md:w-auto px-4 py-2 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition">
                                        Buat Janji
                                    </button>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>

                <!-- SirkelVital Content -->
                 <div id="sirkel-vital-content" class="page-content">
                    <div class="card">
                        <div id="sirkel-vital-tabs" class="mb-6 border-b">
                            <nav class="flex space-x-2">
                                <button class="tab-button active" data-target="tantangan-tab">Tantangan</button>
                                <button class="tab-button" data-target="papan-skor-tab">Papan Skor</button>
                                <button class="tab-button" data-target="pencapaian-tab">Pencapaian</button>
                            </nav>
                        </div>
                        
                        <!-- Tab Content -->
                        <div id="tantangan-tab" class="tab-content active">
                             <h3 class="text-xl font-bold text-gray-800 mb-4">Tantangan Aktif Saya</h3>
                             <div class="space-y-6">
                                <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="font-medium">Tantangan 10.000 Langkah Harian</span>
                                        <span class="text-sm font-semibold text-emerald-600">+10 Token/hari</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-3"><div class="bg-emerald-500 h-3 rounded-full" style="width: 75%"></div></div>
                                    <p class="text-right text-sm text-gray-500 mt-1">7,500 / 10,000 Langkah</p>
                                </div>
                                 <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="font-medium">Tidur Berkualitas 7 Jam</span>
                                        <span class="text-sm font-semibold text-emerald-600">+5 Token/hari</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-3"><div class="bg-blue-500 h-3 rounded-full" style="width: 100%"></div></div>
                                    <p class="text-right text-sm text-gray-500 mt-1">7j 15m / 7j 0m (Selesai)</p>
                                </div>
                             </div>
                             <button class="mt-6 w-full py-2 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition">Cari Tantangan Baru</button>
                        </div>

                        <div id="papan-skor-tab" class="tab-content">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Papan Skor Sirkel "Keluarga Sehat"</h3>
                            <ul class="space-y-3">
                                <li class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200">
                                    <div class="flex items-center space-x-3"><i data-lucide="trophy" class="text-yellow-500"></i><span class="font-bold">1. Budi Santoso (Anda)</span></div>
                                    <span class="font-bold text-yellow-600">1,520 Poin</span>
                                </li>
                                <li class="flex items-center justify-between p-3 bg-gray-100 rounded-lg">
                                    <div class="flex items-center space-x-3"><span class="font-semibold w-5 text-center">2.</span><span class="font-medium">Ibu Siti</span></div>
                                    <span class="font-semibold text-gray-600">1,350 Poin</span>
                                </li>
                                <li class="flex items-center justify-between p-3 bg-gray-100 rounded-lg">
                                    <div class="flex items-center space-x-3"><span class="font-semibold w-5 text-center">3.</span><span class="font-medium">Ayah Joko</span></div>
                                    <span class="font-semibold text-gray-600">1,210 Poin</span>
                                </li>
                            </ul>
                        </div>

                        <div id="pencapaian-tab" class="tab-content">
                             <h3 class="text-xl font-bold text-gray-800 mb-4">Lencana Pencapaian Saya</h3>
                             <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 text-center">
                                <div class="p-4 bg-gray-50 rounded-lg">
                                    <i data-lucide="flame" class="w-12 h-12 text-orange-500 mx-auto"></i>
                                    <p class="font-semibold mt-2">Pejuang 7 Hari</p>
                                    <p class="text-xs text-gray-500">Aktif 7 hari berturut-turut</p>
                                </div>
                                <div class="p-4 bg-gray-50 rounded-lg">
                                    <i data-lucide="footprints" class="w-12 h-12 text-blue-500 mx-auto"></i>
                                    <p class="font-semibold mt-2">Maraton Mini</p>
                                    <p class="text-xs text-gray-500">Mencapai 100rb langkah</p>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>

                <!-- SirkelBakti Content -->
                <div id="sirkel-bakti-content" class="page-content">
                    <div class="card">
                         <h3 class="text-xl font-bold text-gray-800 mb-4">Pantau Kesehatan Keluarga (SirkelBakti)</h3>
                         <div class="space-y-4">
                            <!-- Family Member 1 -->
                            <div class="p-4 bg-gray-50 rounded-lg border">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <img src="https://placehold.co/50x50/FFE4E6/DC2626?text=Ibu" class="w-12 h-12 rounded-full" alt="Ibu">
                                        <div>
                                            <p class="font-bold text-lg">Ibu Siti</p>
                                            <p class="text-sm text-gray-500">Hubungan: Ibu</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-sm font-medium text-emerald-600">Imbalan Terkumpul</p>
                                        <p class="font-bold">+150 Token</p>
                                    </div>
                                </div>
                                <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="p-3 bg-white rounded-md">
                                        <p class="text-sm font-semibold">Pengingat Minum Obat</p>
                                        <p class="text-gray-600">Jadwal: 08:00 & 20:00</p>
                                        <button class="mt-2 w-full text-sm py-1.5 bg-blue-100 text-blue-700 rounded hover:bg-blue-200">Kirim Pengingat</button>
                                    </div>
                                    <div class="p-3 bg-white rounded-md">
                                        <p class="text-sm font-semibold">Jadwal MCU</p>
                                        <p class="text-gray-600">Berikutnya: 15 Okt 2025</p>
                                        <button class="mt-2 w-full text-sm py-1.5 bg-emerald-100 text-emerald-700 rounded hover:bg-emerald-200">Antar & Dapatkan +25 Token</button>
                                    </div>
                                </div>
                            </div>
                         </div>
                    </div>
                </div>

                <!-- Marketplace Content -->
                <div id="marketplace-content" class="page-content">
                    <div class="card">
                        <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                             <h2 class="text-2xl font-bold">Marketplace</h2>
                             <div class="flex space-x-2 mt-4 md:mt-0">
                                <button class="px-4 py-1.5 text-sm bg-emerald-500 text-white font-semibold rounded-full">Semua</button>
                                <button class="px-4 py-1.5 text-sm bg-gray-200 text-gray-700 font-semibold rounded-full">Kebugaran</button>
                                <button class="px-4 py-1.5 text-sm bg-gray-200 text-gray-700 font-semibold rounded-full">Makanan Sehat</button>
                                <button class="px-4 py-1.5 text-sm bg-gray-200 text-gray-700 font-semibold rounded-full">Voucher</button>
                             </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                            <!-- Product Card -->
                            <div class="bg-gray-50 rounded-lg p-4 text-center border hover:shadow-lg transition">
                                <img src="https://placehold.co/150x150/e0f2f1/10b981?text=Gym" alt="Product" class="w-full h-32 object-cover rounded-md mx-auto">
                                <p class="font-bold mt-4">Voucher Gym 1 Bulan</p>
                                <p class="text-sm text-gray-500">Fitness Center</p>
                                <p class="text-emerald-600 font-bold my-2">2,500 Token</p>
                                <button class="w-full mt-2 py-2 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition">Tukar</button>
                            </div>
                             <div class="bg-gray-50 rounded-lg p-4 text-center border hover:shadow-lg transition">
                                <img src="https://placehold.co/150x150/e0f2f1/10b981?text=MCU" alt="Product" class="w-full h-32 object-cover rounded-md mx-auto">
                                <p class="font-bold mt-4">Paket Medical Check-Up</p>
                                <p class="text-sm text-gray-500">Klinik Sehat Selalu</p>
                                <p class="text-emerald-600 font-bold my-2">5,000 Token</p>
                                <button class="w-full mt-2 py-2 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition">Tukar</button>
                            </div>
                            <div class="bg-gray-50 rounded-lg p-4 text-center border hover:shadow-lg transition">
                                <img src="https://placehold.co/150x150/e0f2f1/10b981?text=Katering" alt="Product" class="w-full h-32 object-cover rounded-md mx-auto">
                                <p class="font-bold mt-4">Katering Sehat 1 Minggu</p>
                                <p class="text-sm text-gray-500">Dapur Fit</p>
                                <p class="text-emerald-600 font-bold my-2">1,750 Token</p>
                                <button class="w-full mt-2 py-2 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition">Tukar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dompet Content -->
                <div id="dompet-content" class="page-content">
                     <div class="card">
                        <h2 class="text-2xl font-bold mb-4">Riwayat Transaksi</h2>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="p-3 font-semibold">Tanggal</th>
                                        <th class="p-3 font-semibold">Deskripsi</th>
                                        <th class="p-3 font-semibold text-right">Jumlah</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b">
                                        <td class="p-3">27 Sep 2025</td>
                                        <td class="p-3 flex items-center space-x-2"><i data-lucide="arrow-down-circle" class="text-emerald-500"></i><span>Token dari Tidur Cukup</span></td>
                                        <td class="p-3 text-right font-semibold text-emerald-600">+5.00</td>
                                    </tr>
                                    <tr class="border-b">
                                        <td class="p-3">26 Sep 2025</td>
                                        <td class="p-3 flex items-center space-x-2"><i data-lucide="arrow-up-circle" class="text-red-500"></i><span>Penukaran Voucher Kopi</span></td>
                                        <td class="p-3 text-right font-semibold text-red-600">-25.00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Perangkat Content -->
                <div id="perangkat-content" class="page-content">
                    <div class="card max-w-2xl mx-auto">
                        <h2 class="text-2xl font-bold mb-6">Kelola Perangkat Terhubung</h2>
                        <div class="p-4 border rounded-lg flex items-center justify-between">
                             <div class="flex items-center space-x-4">
                                <i data-lucide="smartphone" class="w-10 h-10 text-emerald-600"></i>
                                <div>
                                    <p class="font-bold">Apple Watch (Budi)</p>
                                    <p class="text-sm text-gray-500">Terakhir sinkron: Baru saja</p>
                                </div>
                             </div>
                             <button class="px-4 py-2 bg-red-100 text-red-700 font-semibold rounded-lg">Putuskan</button>
                        </div>
                         <h3 class="text-xl font-bold mt-8 mb-4">Hubungkan Perangkat Baru</h3>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <button class="w-full p-4 border rounded-lg flex items-center space-x-3 hover:bg-gray-50">
                                <i data-lucide="smartphone" class="w-6 h-6"></i>
                                <span class="font-semibold">Hubungkan Google Fit</span>
                            </button>
                             <button class="w-full p-4 border rounded-lg flex items-center space-x-3 hover:bg-gray-50">
                                <i data-lucide="smartphone" class="w-6 h-6"></i>
                                <span class="font-semibold">Hubungkan Apple Health</span>
                            </button>
                         </div>
                    </div>
                </div>

                <!-- Profil Content -->
                <div id="profil-content" class="page-content">
                     <div class="card max-w-2xl mx-auto">
                        <h2 class="text-2xl font-bold mb-6">Profil Saya</h2>
                        <div class="space-y-4">
                            <div>
                                <label class="font-semibold text-sm">Nama Lengkap</label>
                                <input type="text" value="Budi Santoso" class="w-full mt-1 p-2 border rounded-md bg-gray-100" readonly>
                            </div>
                            <div>
                                <label class="font-semibold text-sm">Email</label>
                                <input type="email" value="budi.s@email.com" class="w-full mt-1 p-2 border rounded-md bg-gray-100" readonly>
                            </div>
                            <button class="w-full py-2 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600 transition">Ubah Profil</button>
                        </div>
                    </div>
                </div>

                <!-- Tata Kelola Content -->
                <div id="tata-kelola-content" class="page-content">
                    <div class="card">
                        <h2 class="text-2xl font-bold mb-4">Tata Kelola Komunitas (DAO)</h2>
                        <p class="mb-6 text-gray-600">Gunakan PulseToken Anda untuk memberikan suara pada proposal yang akan membentuk masa depan ekosistem PulseSirkel. Setiap token adalah suara Anda.</p>
                        
                        <h3 class="text-xl font-bold mb-4">Proposal Aktif</h3>
                        <div class="p-4 border rounded-lg space-y-3">
                             <h4 class="font-bold text-lg">Kemitraan Baru dengan Toko Organik?</h4>
                             <p class="text-sm text-gray-500">Proposal untuk menambahkan "Toko Sehat Organik" sebagai mitra baru di Marketplace.</p>
                             <div class="flex space-x-4 pt-2">
                                <button class="w-full py-2 bg-emerald-500 text-white font-semibold rounded-lg hover:bg-emerald-600">Setuju</button>
                                <button class="w-full py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300">Tidak Setuju</button>
                             </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // --- Element Selectors ---
        const menuToggle = document.getElementById('menu-toggle');
        const sidebar = document.getElementById('sidebar');
        const sidebarNav = document.getElementById('sidebar-nav');
        const pageTitle = document.getElementById('page-title');
        const notifToggle = document.getElementById('notif-toggle');
        const notifDropdown = document.getElementById('notif-dropdown');
        const tukarTokenBtn = document.getElementById('tukar-token-btn');
        const sirkelVitalTabs = document.getElementById('sirkel-vital-tabs');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        const sidebarClose = document.getElementById('sidebar-close');


        // Gemini AI Elements
        const aiPromptForm = document.getElementById('ai-prompt-form');
        const aiPromptInput = document.getElementById('ai-prompt-input');
        const aiTipResponse = document.getElementById('ai-tip-response');
        
        const aiChatForm = document.getElementById('ai-chat-form');
        const aiChatInput = document.getElementById('ai-chat-input');
        const aiChatResponse = document.getElementById('ai-chat-response');
        const aiChatLoading = document.getElementById('ai-chat-loading');


        // --- Functions ---
        const openSidebar = () => {
            sidebar.classList.remove('-translate-x-full');
            sidebarOverlay.classList.remove('hidden');
        };

        const closeSidebar = () => {
            sidebar.classList.add('-translate-x-full');
            sidebarOverlay.classList.add('hidden');
        };
        
        // Function to navigate between pages
        function navigateTo(targetId) {
            const link = document.querySelector(`.sidebar-link[data-target="${targetId}"]`);
            if (!link) return;

            const targetTitle = link.dataset.title;
            const targetContent = document.getElementById(targetId + '-content');

            sidebarNav.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
            link.classList.add('active');
            
            document.querySelectorAll('.page-content').forEach(c => c.classList.remove('active'));
            if (targetContent) {
                targetContent.classList.add('active');
            }
            pageTitle.textContent = targetTitle;
            
            // Close sidebar on navigation in mobile view
            if (window.innerWidth < 768) {
                closeSidebar();
            }
        }
        
        // --- Event Listeners ---
        menuToggle.addEventListener('click', openSidebar);
        sidebarClose.addEventListener('click', closeSidebar);
        sidebarOverlay.addEventListener('click', closeSidebar);
        
        sidebarNav.addEventListener('click', (e) => {
            const link = e.target.closest('.sidebar-link');
            if (!link) return;
            e.preventDefault();
            navigateTo(link.dataset.target);
        });
        
        tukarTokenBtn.addEventListener('click', () => navigateTo('marketplace'));
        
        notifToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            notifDropdown.classList.toggle('hidden');
        });

        window.addEventListener('click', (e) => {
            if (!notifDropdown.classList.contains('hidden') && !notifDropdown.contains(e.target) && !notifToggle.contains(e.target)) {
                notifDropdown.classList.add('hidden');
            }
        });

        // Tab navigation for SirkelVital
        if (sirkelVitalTabs) {
            sirkelVitalTabs.addEventListener('click', (e) => {
                const button = e.target.closest('.tab-button');
                if (!button) return;

                sirkelVitalTabs.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                const targetId = button.dataset.target;
                document.querySelectorAll('#sirkel-vital-content .tab-content').forEach(content => {
                    content.classList.remove('active');
                    if (content.id === targetId) {
                        content.classList.add('active');
                    }
                });
            });
        }


        // AI Assistant Form Handlers
        aiPromptForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const prompt = aiPromptInput.value.trim();
            if (prompt) {
                navigateTo('asisten-ai'); // Pindah ke halaman AI
                aiChatInput.value = prompt; // Isi input di halaman AI
                handleAIChat(); // Langsung proses pertanyaan
                aiPromptInput.value = ''; // Kosongkan input di dasbor
            }
        });
        
        aiChatForm.addEventListener('submit', (e) => {
             e.preventDefault();
             handleAIChat();
        });

        // --- Gemini API Integration ---
        const API_KEY = ""; // Biarkan kosong, akan di-handle oleh environment
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;

        async function callGeminiAPI(prompt, systemInstruction) {
            const payload = {
                contents: [{ role: "user", parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemInstruction }] },
            };

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API error! status: ${response.status}`);
                }

                const result = await response.json();
                return result.candidates?.[0]?.content?.parts?.[0]?.text || "Maaf, saya tidak bisa merespons saat ini.";
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return "Terjadi kesalahan saat menghubungi Asisten AI. Coba lagi nanti.";
            }
        }

        // Function to get personalized health tip on dashboard load
        async function getInitialAITip() {
            const langkah = document.getElementById('langkah-data').textContent;
            const tidur = document.getElementById('tidur-data').textContent;

            const systemPrompt = "Anda adalah Asisten Kesehatan AI PulseSirkel. Berikan satu saran kesehatan yang singkat (maksimal 2 kalimat), positif, dan sesuai prinsip syariah. Jangan berikan nasihat medis diagnostik.";
            const userPrompt = `Berdasarkan data kesehatan saya hari ini (langkah: ${langkah}, tidur: ${tidur}), berikan saya satu tips kesehatan yang relevan.`;
            
            const response = await callGeminiAPI(userPrompt, systemPrompt);
            aiTipResponse.innerHTML = `<p class="text-gray-700">${response}</p>`;
        }
        
        // Function to handle the full chat interaction
        async function handleAIChat() {
            const prompt = aiChatInput.value.trim();
            if (!prompt) return;

            // Clear placeholder and show loading
            if (aiChatResponse.querySelector('p')) {
                 aiChatResponse.innerHTML = '';
            }
            aiChatLoading.classList.remove('hidden');
            aiChatInput.value = ''; // Clear input
            
            const userMessageHTML = `<div class="text-right my-2"><div class="inline-block bg-emerald-500 text-white p-3 rounded-lg">${prompt}</div></div>`;
            aiChatResponse.innerHTML += userMessageHTML;
            aiChatResponse.scrollTop = aiChatResponse.scrollHeight;

            const systemPrompt = "Anda adalah Asisten Kesehatan AI PulseSirkel. Berikan saran kesehatan yang informatif, positif, dan sesuai dengan prinsip syariah. Jangan memberikan nasihat medis yang bersifat diagnosis. Selalu sarankan untuk berkonsultasi dengan dokter untuk masalah serius. Gunakan paragraf singkat dan poin jika perlu agar mudah dibaca.";
            
            const response = await callGeminiAPI(prompt, systemPrompt);

            aiChatLoading.classList.add('hidden');
            const aiMessageHTML = `<div class="text-left my-2"><div class="inline-block bg-white text-gray-800 p-3 rounded-lg border">${response.replace(/\n/g, '<br>')}</div></div>`;
            aiChatResponse.innerHTML += aiMessageHTML;
            aiChatResponse.scrollTop = aiChatResponse.scrollHeight;
        }


        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', () => {
            getInitialAITip();
        });

    </script>
</body>
</html>

